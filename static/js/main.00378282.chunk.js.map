{"version":3,"sources":["App.js","index.js","../../node_modules/uuid/dist/esm-node/rng.js","../../node_modules/uuid/dist/esm-node/bytesToUuid.js","../../node_modules/uuid/dist/esm-node/v35.js","../../node_modules/uuid/dist/esm-node/v3.js","../../node_modules/uuid/dist/esm-node/md5.js","../../node_modules/uuid/dist/esm-node/v4.js","../../node_modules/uuid/dist/esm-node/v5.js","../../node_modules/uuid/dist/esm-node/sha1.js","../../src/index.js"],"names":["SomeHeadings","headingsContainerRef","useRef","useState","pageHeadingNodes","setPageHedingNodes","pageHeadingTree","setPageHeadingTree","useEffect","headingNodes","current","querySelectorAll","usePageHeadingsTree","className","ref","id","map","renderNodeList","node","key","text","childNodes","length","App","ReactDOM","render","document","getElementById","rng","randomBytes","byteToHex","i","toString","substr","bytesToUuid","buf","offset","bth","join","name","version","hashfunc","generateUUID","value","namespace","off","str","unescape","encodeURIComponent","bytes","Array","charCodeAt","stringToBytes","uuid","replace","hex","push","parseInt","uuidToBytes","isArray","TypeError","concat","idx","err","DNS","URL","v35","Buffer","from","createHash","update","digest","v4","options","rnds","random","ii","getParentMap","headingLevel","latestRoots","Object","transformRootNode","expanded","getFlatNodeListFromHeadings","headings","roots","H2","H3","H4","H5","H6","getDefaultRoot","heading","index","childrenCount","rootId","element","tagName","test","Error","checkTag","h","parentMap","getNodeTreeFromFlatNodeList","shouldDefaultToExpand","rootKeys","parents","currentRoot","child","parentId","parent","checkParent","React","finalRoots","callback"],"mappings":"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","file":"static/js/main.00378282.chunk.js","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { usePageHeadingsTree } from \"use-page-headings-tree\";\n\nconst SomeHeadings = () => {\n\tconst headingsContainerRef = useRef();\n\tconst [pageHeadingNodes, setPageHedingNodes] = useState([]);\n\tconst [pageHeadingTree, setPageHeadingTree] = useState(null);\n\n\tuseEffect(() => {\n\t\tconst headingNodes = headingsContainerRef.current.querySelectorAll(\n\t\t\t\"h2,h3,h4,h5,h6\"\n\t\t);\n\t\tsetPageHedingNodes(headingNodes);\n\t}, []);\n\n\tusePageHeadingsTree(pageHeadingNodes, setPageHeadingTree, false);\n\n\tconst renderNodeList = (node) => (\n\t\t<li key={node.id}>\n\t\t\t{node.text}\n\t\t\t{node.childNodes.length > 0 ? (\n\t\t\t\t<ul>{node.childNodes.map(renderNodeList)}</ul>\n\t\t\t) : null}\n\t\t</li>\n\t);\n\n\treturn (\n\t\t<div className=\"card bg-light\">\n\t\t\t<div\n\t\t\t\tref={headingsContainerRef}\n\t\t\t\tclassName=\"bg-dark p-3 text-light rounded-top\"\n\t\t\t>\n\t\t\t\t<h1>This is the main page heading (not included)</h1>\n\t\t\t\t<h2 id=\"hid1\">First h2</h2>\n\t\t\t\t<h3 id=\"hid2\">First h3</h3>\n\t\t\t\t<h3 id=\"hid3\">Second h3</h3>\n\t\t\t\t<h2 id=\"hid4\">Second h2</h2>\n\t\t\t\t<h3 id=\"hid5\">Third h3</h3>\n\t\t\t\t<h4 id=\"hid6\">First h4</h4>\n\t\t\t\t<h5 id=\"hid7\">First h5</h5>\n\t\t\t\t<h6 id=\"hid8\">First h6</h6>\n\t\t\t\t<h3 id=\"hid9\">Fourth h3</h3>\n\t\t\t</div>\n\t\t\t<div className=\"p-5\">\n\t\t\t\t<h2>Result</h2>\n\t\t\t\t<pre>\n\t\t\t\t\t{pageHeadingTree ? (\n\t\t\t\t\t\t<ul>{pageHeadingTree.map(renderNodeList)}</ul>\n\t\t\t\t\t) : null}\n\t\t\t\t</pre>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst App = () => {\n\treturn (\n\t\t<div className=\"m-5\">\n\t\t\t<SomeHeadings />\n\t\t</div>\n\t);\n};\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","import crypto from 'crypto';\nexport default function rng() {\n  return crypto.randomBytes(16);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nexport default bytesToUuid;","import bytesToUuid from './bytesToUuid.js';\n\nfunction uuidToBytes(uuid) {\n  // Note: We assume we're being passed a valid uuid string\n  var bytes = [];\n  uuid.replace(/[a-fA-F0-9]{2}/g, function (hex) {\n    bytes.push(parseInt(hex, 16));\n  });\n  return bytes;\n}\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = new Array(str.length);\n\n  for (var i = 0; i < str.length; i++) {\n    bytes[i] = str.charCodeAt(i);\n  }\n\n  return bytes;\n}\n\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function (name, version, hashfunc) {\n  var generateUUID = function (value, namespace, buf, offset) {\n    var off = buf && offset || 0;\n    if (typeof value == 'string') value = stringToBytes(value);\n    if (typeof namespace == 'string') namespace = uuidToBytes(namespace);\n    if (!Array.isArray(value)) throw TypeError('value must be an array of bytes');\n    if (!Array.isArray(namespace) || namespace.length !== 16) throw TypeError('namespace must be uuid string or an Array of 16 byte values'); // Per 4.3\n\n    var bytes = hashfunc(namespace.concat(value));\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      for (var idx = 0; idx < 16; ++idx) {\n        buf[off + idx] = bytes[idx];\n      }\n    }\n\n    return buf || bytesToUuid(bytes);\n  }; // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name;\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","import v35 from './v35.js';\nimport md5 from './md5.js';\nconst v3 = v35('v3', 0x30, md5);\nexport default v3;","import crypto from 'crypto';\n\nfunction md5(bytes) {\n  if (Array.isArray(bytes)) {\n    bytes = Buffer.from(bytes);\n  } else if (typeof bytes === 'string') {\n    bytes = Buffer.from(bytes, 'utf8');\n  }\n\n  return crypto.createHash('md5').update(bytes).digest();\n}\n\nexport default md5;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nexport default v4;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nconst v5 = v35('v5', 0x50, sha1);\nexport default v5;","import crypto from 'crypto';\n\nfunction sha1(bytes) {\n  if (Array.isArray(bytes)) {\n    bytes = Buffer.from(bytes);\n  } else if (typeof bytes === 'string') {\n    bytes = Buffer.from(bytes, 'utf8');\n  }\n\n  return crypto.createHash('sha1').update(bytes).digest();\n}\n\nexport default sha1;","import { v4 as uuid } from \"uuid\";\nimport * as React from \"react\";\n\nconst getParentMap = (headingLevel, latestRoots) => {\n\treturn Object.keys(latestRoots)\n\t\t.map((k) => latestRoots[k])\n\t\t.slice(0, headingLevel[1] - 2);\n};\n\nconst transformRootNode = (node, expanded) => ({\n\t...node,\n\tid: node.element.id,\n\ttext: node.element.innerText || node.element.innerHTML,\n\texpanded: expanded,\n});\n\nconst checkParent = (parent) => {\n\tif (!parent) {\n\t\tthrow Error(\n\t\t\t\"(usePageHeadingsTree.js): One of the tree nodes is missing a parent.\\n\" +\n\t\t\t\t\"You may have skipped a heading level in your document or your query may \" +\n\t\t\t\t'not contain a sequential list of heading nodes (Correct: \"h2,h3,h4\" Incorrect: \"h2,h4\")'\n\t\t);\n\t}\n};\n\nconst checkTag = (tagName) => {\n\tif (!/^H[2-6]$/.test(tagName)) {\n\t\tthrow Error(\n\t\t\t`(usePageHeadingsTree.js): <${tagName.toLowerCase()}> elements are not supported. ` +\n\t\t\t\t` Only heading elements (<h2> through <h6>)  are supported (for now).`\n\t\t);\n\t}\n};\n\nconst getFlatNodeListFromHeadings = (headings) => {\n\tconst latestRoots = {};\n\tconst roots = { H2: {}, H3: {}, H4: {}, H5: {}, H6: {} };\n\n\tconst getDefaultRoot = (heading, index) => ({\n\t\tchildrenCount: 0,\n\t\trootId: latestRoots[heading.tagName],\n\t\telement: heading,\n\t\tchildNodes: [],\n\t\tindex: index,\n\t});\n\n\theadings.forEach((h, i) => {\n\t\tcheckTag(h.tagName);\n\n\t\tlatestRoots[h.tagName] = uuid();\n\t\tif (h.tagName === \"H2\") {\n\t\t\troots.H2[latestRoots.H2] = getDefaultRoot(h, i);\n\t\t\treturn;\n\t\t}\n\t\troots[h.tagName][latestRoots[h.tagName]] = {\n\t\t\t...getDefaultRoot(h, i),\n\t\t\tparentMap: getParentMap(h.tagName, latestRoots),\n\t\t};\n\t});\n\n\treturn roots;\n};\n\nconst getNodeTreeFromFlatNodeList = (roots, shouldDefaultToExpand) => {\n\tconst rootKeys = Object.keys(roots);\n\n\tfor (let i = rootKeys.length - 1; i >= 0; i--) {\n\t\tconst parents = roots[rootKeys[i - 1]];\n\t\tconst currentRoot = roots[rootKeys[i]];\n\n\t\tif (currentRoot) {\n\t\t\tObject.keys(currentRoot).forEach((childKey) => {\n\t\t\t\tconst child = transformRootNode(\n\t\t\t\t\tcurrentRoot[childKey],\n\t\t\t\t\tshouldDefaultToExpand\n\t\t\t\t);\n\t\t\t\tif (child.parentMap) {\n\t\t\t\t\tconst parentId =\n\t\t\t\t\t\tchild.parentMap[child.parentMap.length - 1];\n\t\t\t\t\tconst parent = parents[parentId];\n\n\t\t\t\t\tcheckParent(parent);\n\n\t\t\t\t\tparent.childrenCount += child.childNodes.length + 1;\n\t\t\t\t\tparent.childNodes.push(child);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tconst finalRoots = Object.keys(roots.H2).map((k) =>\n\t\ttransformRootNode(roots.H2[k], shouldDefaultToExpand)\n\t);\n\treturn finalRoots;\n};\n\nexport const usePageHeadingsTree = (\n\theadings,\n\tcallback,\n\tshouldDefaultToExpand\n) => {\n\tReact.useEffect(() => {\n\t\tconst roots = getFlatNodeListFromHeadings(headings);\n\t\tconst finalRoots = getNodeTreeFromFlatNodeList(\n\t\t\troots,\n\t\t\tshouldDefaultToExpand\n\t\t);\n\t\tcallback(finalRoots);\n\t}, [headings, shouldDefaultToExpand]);\n};\n"],"sourceRoot":""}